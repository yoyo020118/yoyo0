<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø­Ù‚ÙŠÙ‚ÙŠ - Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f0f2f5; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; }
        
        /* ØªØµÙ…ÙŠÙ… ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø¯Ø®ÙˆÙ„ */
        .card { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); width: 320px; text-align: center; }
        
        .btn-google { background-color: #db4437; color: white; border: none; padding: 12px; width: 100%; border-radius: 6px; font-size: 16px; font-weight: bold; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; transition: 0.3s; }
        .btn-google:hover { background-color: #c23321; }

        .btn-logout { background-color: #555; margin-top: 20px; }
        
        /* Ø´Ø§Ø´Ø§Øª Ø§Ù„Ø¹Ø±Ø¶ */
        #main-app { display: none; }
        #login-screen { display: flex; flex-direction: column; }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø®Ø·Ø£ */
        #error-box { color: #d8000c; background-color: #ffbaba; border: 1px solid #d8000c; padding: 10px; margin-top: 15px; border-radius: 5px; font-size: 13px; display: none; text-align: right; }
        
        .profile-img { width: 80px; height: 80px; border-radius: 50%; margin-bottom: 10px; border: 3px solid #31a24c; }
    </style>
</head>
<body>

    <!-- Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
    <div id="login-screen" class="card">
        <h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
        <p>ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©</p>
        <button class="btn-google" onclick="loginGoogle()">
            <span>G</span> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø¬ÙˆØ¬Ù„
        </button>
        
        <!-- ØµÙ†Ø¯ÙˆÙ‚ Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ -->
        <div id="error-box"></div>
    </div>

    <!-- Ø´Ø§Ø´Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <div id="main-app" class="card">
        <img id="user-photo" class="profile-img" src="" alt="ØµÙˆØ±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
        <h3>Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ <span id="user-name"></span> ğŸ‘‹</h3>
        <p style="color: green; font-weight: bold;">â— Ø£Ù†Øª Ù…ØªØµÙ„ Ø§Ù„Ø¢Ù†</p>
        <button class="btn-google btn-logout" onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
    </div>

    <!-- Ù…ÙƒØªØ¨Ø§Øª Firebase (Ø§Ù„Ø¥ØµØ¯Ø§Ø± 8 Ø§Ù„Ù…ØªÙˆØ§ÙÙ‚ ÙˆÙ‡Ùˆ Ø§Ù„Ø£Ø³Ù‡Ù„) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>

    <script>
        // ===============================================================
        // ğŸ”´ Ù‡Ø§Ù…: Ø§Ø³ØªØ¨Ø¯Ù„ Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø²Ø¡ Ø¨Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø´Ø±ÙˆØ¹Ùƒ Ù…Ù† Firebase Console
        // ===============================================================
        const firebaseConfig = {
            apiKey: "AIzaSyxxxxxxxxx_YOUR_API_KEY_HERE",
            authDomain: "your-project-name.firebaseapp.com",
            projectId: "your-project-name",
            storageBucket: "your-project-name.appspot.com",
            messagingSenderId: "123456789",
            appId: "1:123456789:web:xxxxxx"
        };

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        if (!firebase.apps.length) {
            try {
                firebase.initializeApp(firebaseConfig);
                console.log("Firebase Connected âœ…");
            } catch (e) {
                showError("Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase: ØªØ£ÙƒØ¯ Ù…Ù† Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„ØµØ­ÙŠØ­.");
            }
        }
        const auth = firebase.auth();

        // 1. Ù…Ø±Ø§Ù‚Ø¨Ø© Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ù‡Ù„ Ù‡Ùˆ Ù…Ø³Ø¬Ù„ Ø£Ù… Ù„Ø§ØŸ)
        auth.onAuthStateChanged((user) => {
            if (user) {
                // Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„Ù‡
                document.getElementById('login-screen').style.display = 'none';
                document.getElementById('main-app').style.display = 'block';
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                document.getElementById('user-name').innerText = user.displayName;
                document.getElementById('user-photo').src = user.photoURL;
            } else {
                // Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…Ø³Ø¬Ù„
                document.getElementById('login-screen').style.display = 'flex';
                document.getElementById('main-app').style.display = 'none';
            }
        });

        // 2. Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        function loginGoogle() {
            const provider = new firebase.auth.GoogleAuthProvider();
            document.getElementById('error-box').style.display = 'none'; // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø®Ø·Ø£ Ø§Ù„Ø³Ø§Ø¨Ù‚

            auth.signInWithPopup(provider)
                .then((result) => {
                    console.log("ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­:", result.user);
                })
                .catch((error) => {
                    console.error("Ø®Ø·Ø£ Ø§Ù„ØªØ³Ø¬ÙŠÙ„:", error);
                    handleErrors(error);
                });
        }

        // 3. Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
        function logout() {
            auth.signOut();
        }

        // 4. Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ ÙˆØ¹Ø±Ø¶Ù‡Ø§ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
        function handleErrors(error) {
            let msg = "Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ.";
            
            if (error.code === 'auth/network-request-failed') {
                msg = "âš ï¸ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø´Ø¨ÙƒØ©! <br> 1. ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª. <br> 2. (Ø§Ù„Ø£Ù‡Ù…) ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ Ø£Ø¶ÙØª Ø±Ø§Ø¨Ø· GitHub ÙÙŠ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase Authorized Domains.";
            } else if (error.code === 'auth/unauthorized-domain') {
                msg = "ğŸš« Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆÙ‚Ø¹ ØºÙŠØ± Ù…ØµØ±Ø­ Ù„Ù‡. <br> Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ Firebase Console -> Auth -> Settings -> Authorized Domains ÙˆØ£Ø¶Ù Ø±Ø§Ø¨Ø· Ù…ÙˆÙ‚Ø¹Ùƒ.";
            } else if (error.code === 'auth/popup-closed-by-user') {
                msg = "ØªÙ… Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ù‚Ø¨Ù„ Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„ØªØ³Ø¬ÙŠÙ„.";
            } else if (error.code === 'auth/invalid-api-key') {
                msg = "Ù…ÙØªØ§Ø­ API ØºÙŠØ± ØµØ­ÙŠØ­. ØªØ£ÙƒØ¯ Ù…Ù† Ù†Ø³Ø® Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ø¯Ù‚Ø©.";
            } else {
                msg = error.message;
            }
            showError(msg);
        }

        function showError(message) {
            const box = document.getElementById('error-box');
            box.innerHTML = message;
            box.style.display = 'block';
        }
    </script>
</body>
</html>
