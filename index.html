<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>شات تواصل الحقيقي</title>
    <!-- الخطوط والأيقونات -->
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- ملف الستايل -->
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- شاشة تسجيل الدخول -->
    <div id="login-screen" class="screen active">
        <div class="login-card">
            <div class="logo-area">
                <i class="fas fa-paper-plane"></i>
                <h1>شات تواصل</h1>
            </div>
            <p>سجل اسمك للحصول على "معرف" (ID) خاص بك</p>
            <input type="text" id="username-input" placeholder="اكتب اسمك هنا..." autocomplete="off">
            <button id="login-btn" onclick="registerUser()">إنشاء حساب ودخول</button>
        </div>
    </div>

    <!-- واجهة التطبيق الرئيسية -->
    <div id="app-screen" class="screen">
        
        <!-- القائمة الجانبية -->
        <aside class="sidebar">
            <div class="user-profile">
                <div class="avatar me" id="my-avatar"></div>
                <h3 id="display-name">جاري التحميل...</h3>
                <div class="id-box" onclick="copyMyID()">
                    <span id="my-unique-id">...</span>
                    <i class="fas fa-copy"></i>
                </div>
                <small>اضغط لنسخ الـ ID وإرساله لصديقك</small>
            </div>
            
            <nav class="nav-menu">
                <button class="nav-btn active" onclick="showTab('friends')">
                    <i class="fas fa-comment-dots"></i> المحادثات
                </button>
                <button class="nav-btn" onclick="showTab('requests')">
                    <i class="fas fa-user-plus"></i> الطلبات الواردة
                </button>
                <button class="nav-btn" onclick="showTab('add')">
                    <i class="fas fa-search"></i> إضافة صديق
                </button>
            </nav>

            <button class="logout-btn" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i> خروج
            </button>
        </aside>

        <!-- منطقة المحتوى -->
        <main class="main-content">
            
            <!-- 1. قائمة الأصدقاء -->
            <div id="tab-friends" class="tab-content active">
                <header class="tab-header"><h2>الأصدقاء المتصلين</h2></header>
                <div class="list-container" id="friends-list">
                    <p class="loading-text">لا يوجد أصدقاء، اذهب لتبويب الإضافة.</p>
                </div>
            </div>

            <!-- 2. قائمة الطلبات -->
            <div id="tab-requests" class="tab-content">
                <header class="tab-header"><h2>طلبات الصداقة</h2></header>
                <div class="list-container" id="requests-list">
                    <p class="loading-text">لا توجد طلبات جديدة.</p>
                </div>
            </div>

            <!-- 3. إضافة صديق -->
            <div id="tab-add" class="tab-content">
                <header class="tab-header"><h2>إضافة صديق جديد</h2></header>
                <div class="add-friend-box">
                    <i class="fas fa-id-card-alt"></i>
                    <p>لإضافة صديق، يجب أن يعطيك الـ ID الخاص به.</p>
                    <input type="text" id="friend-id-input" placeholder="لصق الـ ID هنا (مثال: Ali#9321)">
                    <button class="btn-primary" onclick="sendFriendRequest()">إرسال طلب صداقة</button>
                </div>
            </div>

        </main>

        <!-- غرفة الشات -->
        <section id="chat-room" class="chat-room">
            <header class="chat-header">
                <button class="back-btn" onclick="closeChat()"><i class="fas fa-arrow-right"></i></button>
                <div class="chat-user-info">
                    <div class="avatar small" id="chat-avatar"></div>
                    <h3 id="chat-username">الاسم</h3>
                </div>
            </header>

            <div class="messages-area" id="messages-area"></div>

            <div class="chat-input-area">
                <input type="text" id="msg-input" placeholder="اكتب رسالتك..." onkeypress="handleInputKey(event)">
                <button onclick="sendMessage()"><i class="fas fa-paper-plane"></i></button>
            </div>
        </section>

    </div>

    <!-- مكتبات Firebase (ضرورية جداً) -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    
    <!-- ملف الجافاسكريبت الخاص بنا -->
    <script src="script.js"></script>
</body>
</html>